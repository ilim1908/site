function viewPopup(viewID){
	$(viewID).show();
	$(viewID).locationcenter();

/*
	if(!$('#backLayer').length > 0){
		var ifmObj = document.createElement("iframe");
		ifmObj.id = "backLayer";
		document.body.appendChild(ifmObj);
		ifmObj.style.position = "absolute";
	}else{
		$('#backLayer').show();
	}

	var ifmRef = $('#backLayer');
	ifmRef.css("opacity", 60);
	ifmRef.css("MozOpacity", 0.6);
	ifmRef.css("filter", "alpha(opacity=60)");

	ifmRef.css("width", document.body.clientWidth);
	ifmRef.css("height", document.body.scrollHeight);
	ifmRef.css("top", 0);
	ifmRef.css("left", 0);
	ifmRef.css("zIndex", 1);
	ifmRef.css("border", "none");
	ifmRef.css("display", "block");

	$(viewID).css("zIndex", 2);
*/
}

function closePopup(closeID, backLayerID){
	document.body.style.filter = "";
	$("#" + closeID).hide();
	if ($("#" + backLayerID)){
		$("#" + backLayerID).hide();
	}
}

function simpleCheck(f)
{
	if (f == '') var f = document.login_form;

    var url = "https://www.gabia.com/login/simple_ajax.php?jsoncallback=?";
	$.ajax({
		url :       url,
		dataType:   'jsonp',
		type :      "POST",
		async :     false,
		data :      'user_id=' + f.user_id.value,
		error: function () {
			alert ('통신오류');
		},
		success: function (json) {
			if(json.return_code == 1) {
				alert("[GE0060] 아이디 또는 비밀번호 오류입니다.");
				document.location.reload();
				return false;
			}else{
				if (f.name == "g_login_frm") {
					//f.submit();
					glogin.foreignAccessLayer(f, 'g_login_frm');
				}
				else {
					glogin.get_login_result(f);
                    //if($("#glogin_common_layer"))   $("#glogin_common_layer").hide();
                    //glogin.foreignAccessLayer(f, 'glogin.get_login_result');
				}

			}
		}
	});
}

function returnSimpleCheck(returnValue){
	window.alert(returnValue);
	return returnValue;
}

$.fn.locationcenter = function() {
	return this.each(function(){
		var element = $(this);
		var win = $(window);
		var x = win.width();
		var y = win.height();

		element.remove().appendTo("body");
		element.css("position", "absolute");
		element.css("left", (x + win.scrollLeft())/2 - element.width()/2);
		element.css("top", (y + win.scrollTop())/2 - element.height()/2);
	});
};

var simple = {
	change_email_domain: function (value)
	{
		var f = document.member;

		if (value == "직접 입력"){
			f.email_domain.disabled = false;
			f.email_domain.style.visibility = "visible";
		}else{
			f.email_domain.disabled = true;
			f.email_domain.style.visibility = "hidden";
		}
	},
	activate_auth: function (send_type)
	{
		var f = document.member;
		var email = "";
		var hp_no = "";

		if (f.select_email_domain.value == "직접 입력")	{
			email = f.email.value + "@" +  f.email_domain.value;
		}
		else {
			email = f.email.value + "@" +  f.select_email_domain.value;
		}

		hp_no = f.hp_no1.value + "-" + f.hp_no2.value + "-" + f.hp_no3.value;

		if (send_type == $("#simple_auth_type").text()) {
			if (send_type == "ems") {
				if ($("#auth_end_text").val() != email) {
					$("#auth_button").attr('src','/images/member/2012/0828_01.gif');
					$("#auth_button").attr('onClick','simple.open_auth_layer()');
					$("#auth_button").attr('style','cursor:pointer');
				}
				else {
					$("#auth_button").attr('src','/images/member/2012/0828_02.gif');
				}
			}
			else if (send_type == "sms") {
				if ($("#auth_end_text").val() != hp_no ) {
					$("#auth_button").attr('src','/images/member/2012/0828_01.gif');
					$("#auth_button").attr('onClick','simple.open_auth_layer()');
					$("#auth_button").attr('style','cursor:pointer');
				}
				else {
					$("#auth_button").attr('src','/images/member/2012/0828_02.gif');
				}
			}
		}
	},
	open_auth_layer: function ()
	{
		var f = document.member;
		var email = "";
		var hp_no = "";

		if (f.select_email_domain.value == "직접 입력")	{
			email = f.email.value + "@" +  f.email_domain.value;
		}
		else {
			email = f.email.value + "@" +  f.select_email_domain.value;
		}

		hp_no = f.hp_no1.value + "-" + f.hp_no2.value + "-" + f.hp_no3.value;

		if (email == "@" && hp_no == "--") {
			alert("이메일 주소와 휴대폰번호를 입력해주십시오");
			return false;
		}

		if(!simple.isValidEmail (email)) {
			alert("전자우편주소의 형식은 '계정@[호스트|도메인]'과 같이 구성되어야 합니다.");
			f.email.focus();
			return false;
		}

		if(!simple.isValidHpNo (f.hp_no1, f.hp_no2, f.hp_no3)){
			return false;
		}


		$.ajax({
			type: 'POST',
			url: '/ajax/checkemail.php',
			async: false,
			data: 'email='+email,
			dataType: 'json',
			timeout:30000,
			beforeSend: function () {
				var prog = "&nbsp;<img src='/assets/images/payment/2007/progress.gif' border='0' align='absmiddle'><font color='darkred'>&nbsp;사용 가능한 이메일인지 확인 중입니다.</font>";
				$("#check_msg_mail").show();
				$("#check_msg_mail_sp").html(prog);
			},
			error: function (XMLHttpRequest, textStatus, errorThrown) {
				alert ("통신오류");
			},
			ontimeout:function () {
				alert ("요청시간 초과");
			},
			success: function(response) {
				if (!response['result']) {
					$("#check_msg_mail").hide();
					$("#check_msg_mail_sp").html("");

					alert('입력하신 이메일 주소를 다시 확인해주시기 바랍니다.\n\n계속해서 같은 오류가 발생하면,\n\n다른 이메일 주소를 입력해주시기 바랍니다.');
				}
				else {
					$("#send_email").text(email);
					$("#send_hpno").text(hp_no);

					$('.ui-dialog').maxZIndex();
					$("#auth_hp_layer").dialog('open');

//					$('#auth_hp_layer').removeClass('ui-widget-overlay').addClass('ui-widget-overlay_new');
//					$('#auth_email_layer').removeClass('ui-widget-overlay').addClass('ui-widget-overlay_new');

//					$("#tableSimpleRegistLayer").css("zIndex", 1);
//					$("#auth_hp_layer").css("zIndex", 2);
//					$("#auth_email_layer").css("zIndex", 2);
				}
			},

			complete: function(XMLHttpRequest, textStatus) {

				$("#check_msg_mail").hide();
				$("#check_msg_mail_sp").html("");

				if(textStatus == "success") {
				}
			}
		});

	},

	isValidEmail: function (value)
	{
		// contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
		return /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(value);
	},

	isValidHpNo: function (hp_no1, hp_no2, hp_no3)
	{
		var numeric = '1234567890';

		if (hp_no2.value.length < 3) {
			alert("휴대폰번호의 형식은 '010-123-4567'과 같이 구성되어야 합니다.");
			hp_no2.focus();
			return false;
		}
		else if (!simple.checknorm(hp_no2,  '휴대폰번호', numeric, 4)) {
			hp_no2.focus();
			return false;
		}
		else if (hp_no3.value.length < 4) {
			alert("휴대폰번호의 형식은 '010-123-4567'과 같이 구성되어야 합니다.");
			hp_no3.focus();
			return false;
		}
		else if (!simple.checknorm(hp_no3,  '휴대폰번호', numeric, 4)) {
			hp_no3.focus();
			return false;
		}

		return true;
	},
	checknorm: function (target, cmt, astr, lmax)
	{
		var i;
		var t = target.value;
		if (t.length == 0 ) {
				//alert(cmt + '(을)를 기재하지 않으셨습니다.');
				alert(cmt + '를 기재하지 않으셨습니다.');
				return false;
		}
		if (lmax != 0 && t.length > lmax) {
				alert(cmt + '는 ' + lmax + '자 이내만 허용합니다.');
				return false;
		}
		if (astr.length >= 1) {
				for (i=0; i<t.length; i++)	{
					if(astr.indexOf(t.substring(i,i+1))<0) {
						alert(cmt + '에 허용할 수 없는 문자가 입력되었습니다');
						return false;
						break;
					}
				}
				return true;
		}
	}
}
