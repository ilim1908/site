/**
 * @author : lmk@gabia.com
 * @brief : 기본 국번, 메일도메인 정의
 */
var arr_email_domain = ["hanmail.net","naver.com","empal.com","paran.com","nate.com","korea.com","hitel.net","unitel.co.kr","kornet.net","nownuri.net","gmail.com","lycos.co.kr","hanafos.com","dreamwiz.com","hanmir.com","freechal.com","chollian.net","yahoo.co.kr","hotmail.com"];
var arr_phone = ['02','031','032','033','041','042','043','044','051','052','053','054','055','061','062','063','064','070','0303','0502','0505','0506'];
var arr_hp_no = ['010', '011', '016', '017', '018', '019'];

/**
 * @author : lmk@gabia.com
 * @brief : dropdown select menu styler function
 */
 var divselect = {
	action : function(el,state){
		this.el = el;
		$(window).on('mouseup', function(e){
			if(e.which == 1){
				if($(e.target).prop('class') == 'selectBox'){
					e.stopPropagation();
					return;
				}

				if($(e.target).parents('div[class="selectBox"]').length){
					e.stopPropagation();
					return;
				}

				var target = $(e.target).prop('name');
				if(target == ""){
					target = $(e.target).children('a').prop('name');
				}

				if(target != 'selectElement'){
					divselect.close($(divselect.el).children('ul'));
				}
			}
			e.stopPropagation();
		});
		var SelectElement = $(el);
		var ListElement = SelectElement.children('ul');
		var ActionElement = ListElement.find('a');
		if(ListElement.css('display') == "block"){
			divselect.close(ListElement);
			return false;
		} else {
			ListElement.show();
		}

		ActionElement.prop('name', 'selectElement');
		var strSelected = SelectElement.children("a:first-child").children('p');
		strSelected.focus();

		for(var i=0; i<ActionElement.length; i++){
			if ($(strSelected).text() == $(ActionElement[i]).text()) {
				divselect.elementClass = ActionElement[i];
				divselect.elementClass.className = "selected";
				ActionElement[i].onclick = function(){
					return false;
				}
			} else {
				ActionElement[i].onclick = function(){
					if(this.href.indexOf("javascript")>-1){
						eval(this.href);
					} else if(this.href == "" || this.href.indexOf("#")>-1){
					} else if(this.target == "_blank"){
						window.open(this.href);
					} else {
						location.href(this.href);
					}
					if(state==1){
						$(strSelected).html($(this).text());
					}
					return false;
				}
			}
			ActionElement[i].onmouseover = function(){
				divselect.elementClass = "";
				this.className = "selected";
				divselect.elementClass = this;
			}
		}

		SelectElement.onmouseover = function(){ strSelected.onblur = function(){}}
		SelectElement.onmouseout = function(){ strSelected.onblur = function(){ divselect.close(ListElement); }}

	},
	close : function(el){
		$(window).off('mouseup');
		divselect.elementClass = "";
		$(el).hide();
		return false;
	}
}

/**
 * @author : lmk@gabia.com
 * @brief : service highlight search
 * @usage : <input type="text" id="searchServiceText" class="search" onkeypress="event.keyCode==13 ? highlight() : ''">
 *			<button class="btn" id="btnSearchService" onclick="highlight()"><span>검색</span></button>
 */
var searchContents;
function highlight(options)
{
	var o = {
		words: $('#searchServiceText').val(),
		caseSensitive: false,
		wordsOnly: true,
		template: '$1<span class="highlight">$2</span>$3'
	}, pattern;
	$.extend(true, o, options || {});
	if (o.words.length == 0) return;
	$('.highlight').removeClass("highlight");
	pattern = new RegExp('(>[^<.]*)(' + o.words + ')([^<.]*)', o.caseSensitive ? "" : "ig");

	var content = $('#allServiceList').html();
	if (!content) return;

	$('#allServiceList').html(content.replace(pattern, o.template));
	$('#searchServiceText').focus();
}

var objCookie = {
	setCookie : function(name, value, expire)
	{
		var eDate = new Date();
		eDate.setDate(eDate.getDate() + expire);
		document.cookie = name + "=" + value + "; expires=" +  eDate.toGMTString()+ "; path=/";
	},
	getCookie : function(name)
	{
		var nameOfCookie = name + "=";
		var x = 0;
		while ( x <= document.cookie.length ) {
			var y = (x+nameOfCookie.length);
			if ( document.cookie.substring( x, y ) == nameOfCookie ) {
				if ( (endOfCookie=document.cookie.indexOf( ";", y )) == -1 )
					endOfCookie = document.cookie.length;
				return unescape( document.cookie.substring( y, endOfCookie ) );
			}
			x = document.cookie.indexOf( " ", x ) + 1;
			if ( x == 0 ) break;
		}
		return "";
	},
	getCookieMobileReferer: function(name) {
		var dc = document.cookie;
		var prefix = name + "=";
		var begin = dc.indexOf("; " + prefix);
		if (begin == -1) {
			begin = dc.indexOf(prefix);
			if (begin != 0) return null
		} else {
			begin += 2
		}
		var end = document.cookie.indexOf(";", begin);
		if (end == -1) {
			end = dc.length
		}
		return unescape(dc.substring(begin + prefix.length, end))
	}
}

/**
 * @author : lmk@gabia.com
 * @brief : common tab controller
 */
function commonTab(el, options)
{
	var tabWrap = $(el).parents('ul').attr('id');

	$(el).parents('ul').find('li').removeClass('on');	/// 탭 활성화 css class 제거
	$('div[id^='+tabWrap+']').hide();				/// 탭 컨텐츠 감춤
	$(el).parent().addClass('on');					/// 클릭된 메뉴 상위 li 탭 활성화
	setTabContents($('#' + $(el).attr('rel')), options);/// 클릭된 탭 컨텐츠 활성화 동작 정의함수
}

/**
 * @author : lmk@gabia.com
 * @brief : 탭 안에 탭을 넣는 경우, li 가 아닌 a 에 on class 두는 경우..
 */
function commonSubTab(el, options)
{
	var tabWrap = $(el).parents('ul').attr('id');

	$(el).parents('ul').find('a').removeClass('on');	/// 탭 활성화 css class 제거
	$('div[id^='+tabWrap+']').hide();				/// 탭 컨텐츠 감춤
	$(el).addClass('on');					/// 클릭된 메뉴 상위 li 탭 활성화
	setTabContents($('#' + $(el).attr('rel')), options);	/// 클릭된 탭 컨텐츠 활성화 동작 정의함수
}

/**
 * @options
 * callback : 콜백함수 정의
 * url : load url 정의
 * data : load 시 전달할 object 데이터
 */
function setTabContents(el, options)
{
	/// options : 확장기능을 사용하기 위한 옵션
	/// 기본값 : show, hide
	/// options 정의 예시 : {'url':'/welcome','data':{'arg1':'val1','arg2':'val2'},'callback':'callFund(\'string\')'}
	var defaults = {'url':null,'data':null,'callback':null};
	var options = $.extend(defaults, options || {});
	if (options.url != undefined) {
		/// ajax load url
		$(el).load(options.url, options.data, eval(options.callback)).show();
	} else {
		$(el).show(0, eval(options.callback));
	}
}

/**
 * @author : lmk@gabia.com
 * @brief : common layer script
 */
var current_glayer_id;
var gLayer = {
	open:function(el, bg, dg, lc)
	{
		var elo = $('#'+el);
		var tmp = document.createElement('div');
		var xCoor, yCoor;
		var maskHeight = $(document).height();
		var maskWidth = $(document).width();
		if(lc)	$('#'+el+'LayerPopup').remove();
		$(tmp).attr('id',el+'LayerPopup')
			  .addClass(el+'LayerPopupClass')
			  .css({'position':'absolute','top':0,'left':0,'width':maskWidth,'height':maskHeight,'z-index':$.maxZIndex})
			  .hide()
			  .appendTo('body');

		var cont_width = (elo.find('div').width()) ? elo.find('div').width() :  elo.width();
		var cont_height = (elo.find('div').height()) ? elo.find('div').height() : elo.height();
		var xCoor = ( $(window).scrollLeft() + ($(window).width() - cont_width)/2 );
		var yCoor = ( $(window).scrollTop() + ($(window).height() - cont_height)/2 );

		if(yCoor < 0) yCoor = 0;

		current_glayer_id = el + 'LayerContents';
		$('<div id="'+el+'LayerContents"></div>').css({'position':'absolute','left':xCoor,'top':yCoor}).appendTo('#'+el+'LayerPopup');
		elo.children().clone(true).appendTo('#'+el+'LayerContents');

		if (bg){
			var bglayer = document.createElement('div');
			$('#'+el+'LayerPopup').prepend(
				$(bglayer).css({'width':'100%','height':'100%','position':'absolute','top':0,'left':0,'background':'#000','opacity':'.5','filter':'alpha(opacity=50)'})
			);
		}
		// 드래그를 사용하고 싶다면.
		if (dg) $('#'+el+'LayerContents').draggable({ handle: "div.Puptop", containment: "body" });
		/// 기존 팝업div 는 백업
		elo.empty();
		$('#'+el+'LayerPopup').show();
	},
	close:function(el)
	{
		//var restore = document.createElement('div');
		//$(restore).attr('id', el).css('display','none').appendTo('body');
		$('#' + el + 'LayerContents').children().clone(true).appendTo('#'+el);
		$('.' + el + 'LayerPopupClass').hide().remove();
		current_glayer_id = '';
	},
	relocate:function(el)
	{
		///
		var elo = $('#'+el);
		var cont_width = (elo.find('div').width()) ? elo.find('div').width() :  elo.width();
		var cont_height = (elo.find('div').height()) ? elo.find('div').height() : elo.height();
		var xCoor = ( $(window).scrollLeft() + ($(window).width() - cont_width)/2 );
		var yCoor = ( $(window).scrollTop() + ($(window).height() - cont_height)/2 );
		$('#' + el).css({'position':'absolute','left':xCoor,'top':yCoor});
	},
	isShow : function(el){
		return $('#'+el).is(":visible");
	},
	openHelp:function(el, e, xpos, ypos)
	{
		if ( e != undefined )
		{
			if(e && e.stopPropagation){
				e.stopPropagation();
			}else{
				if ( window.event )
					window.event.cancelBubble = true;
				else
					e.cancelBubble = true;
			}
		}

		var tgel;
		if (e) {
			if (typeof e.target != undefined) tgel = e.target;
			else tgel = e.srcElement;
		}
		var tg_width = tg_height = 0;
		if ( tgel )
		{
			tg_width = ( tgel.clientWidth ) ? tgel.clientWidth : tgel.offsetWidth + 10;
			tg_height = ( tgel.clientHeight ) ? tgel.clientHeight : tgel.offsetHeight;
		}
		var elo = $('#'+el);
		var xCoor, yCoor;
		var cont_width = ( elo.find('div').width() ) ? elo.find('div').width() :  elo.width();
		var cont_height = ( elo.find('div').height() ) ? elo.find('div').height() : elo.height();

		/// 클릭한 위치좌표에서 팝업띄우기
		var e = e || window.event;
		if (e) {
			xCoor = xpos ? xpos : (e.pageX || elo.scrollLeft() + e.clientX);
			yCoor = ypos ? ypos : (e.pageY || elo.scrollTop() + e.clientY);
			if ( $.browser.msie && $.browser.version < 9 )
			{
				xCoor = xpos ? xpos : (e.pageX || e.clientX + $(window).scrollLeft());
				yCoor = ypos ? ypos : (e.pageY || e.clientY + $(window).scrollTop());
			}
			/// 클릭좌표가 우측으로 치우친 경우
			if ( $(window).width() < (xCoor + cont_width + tg_width) ) xCoor = ($(window).scrollLeft() + $(window).width()) - (cont_width + tg_width + 10);
			if ( xCoor < 0 ) xCoor =  $(window).scrollLeft();
			/// 클릭좌표가 페이지 끝부분인 경우
			if ( ($(window).scrollTop() + cont_height) > yCoor ) yCoor = yCoor + tg_height + 3;
			else yCoor = yCoor - cont_height - tg_height - 5;
			xCoor += 'px';
			yCoor += 'px';
		} else {
			xCoor = ($(window).width()/2 - (cont_width/2)) + 'px';
			yCoor = ($(document).height()/2) + 'px';
		}

		/// 2013-05-23, lmk x,y postion 지정된 경우 좌표계산없이 해당 좌표에서 뜨도록 변경
		if (xpos !== null && xpos !== undefined) xCoor = xpos + 'px';
		if (ypos !== null && ypos !== undefined) yCoor = ypos + 'px';
		$('#'+el).css({'position':'absolute','top':yCoor,'left':xCoor, 'z-index':$.maxZIndex}).show();
	},
	closeHelp:function(el)
	{
		$('#'+el).hide();
	},
	openPopup:function(url, e, bg)
	{
		/**
		 * @author : lmk@gabia.com
		 * @date : 2013-10-02
		 * @brieft : 공통 레이어 호출
		 */
		if ($('#guide_common_popup_layer')) {
			gLayer.closePopup();
		}

		var tmp = document.createElement('div');
		$(tmp).attr('id','guide_common_popup_layer')
			  .hide()
			  .appendTo('body');

		$('#guide_common_popup_layer').load(
			url, function() {
				if (e) {
					gLayer.openHelp('guide_common_popup_layer', e);
				} else {
                    _bg = 'undefined' == bg? false : bg;
					gLayer.open('guide_common_popup_layer',_bg);
				}
			}
		);
	},
	closePopup:function()
	{
		gLayer.closeHelp('guide_common_popup_layer');
		gLayer.close('guide_common_popup_layer');
		$('#guide_common_popup_layer').remove();
	},
	show:function(el, modal, div)
	{
		var elo = $('#'+el);
		var xCoor, yCoor;
		var maskHeight = $(document).height();

		var cont_width = elo.width();
		var cont_height = elo.height();
		var xCoor = ( $(window).scrollLeft() + ($(window).width() - cont_width)/2 );
		var yCoor = ( $(window).scrollTop() + ($(window).height() - cont_height)/2 );
		if(div){
			var xCoor = 100;
			var yCoor = 100;
		}

		if(yCoor < 0) yCoor = 0;
		if (modal){
			var bglayer = document.createElement('div');
			$('body').append(
				$(bglayer).attr('id',el + 'showPopupBackground').css({'width':'100%','height':maskHeight,'overflow':'hidden','position':'absolute','top':0,'left':0,'background':'#000','opacity':'.5','filter':'alpha(opacity=50)','z-index':$.maxZIndex})
			);
		}
		elo.css({'position':'absolute','left':xCoor,'top':yCoor,'z-index':$.maxZIndex}).show();;
	},
	hide:function(el)
	{
		$('#' + el + 'showPopupBackground').hide().remove();
		$('#' + el).hide();
	}
};

/**
 * @author : lmk@gabia.com
 * @brief : 스크롤 배너용 스크립트
 * @date : 2013-07-29
 */
var gScrolls = null;
var scroll_banner;
var gScrollBanner = {
	start:function(el, top, bottom) {
		if (top == undefined) top = 381;
		if (bottom == undefined) bottom = 151;
		scroll_banner = setInterval(function() {gScrollBanner.scroll('.quickMenu',top,bottom)}, 500);
		var quickHeight = parseInt($('.aside .quickMenu').height()); // bangsh 2013-11-18
		$('#request_content').css({ 'min-height' : quickHeight + 10 + 'px' }); // bangsh 2013-11-18
	},
	scroll:function(el, top, bottom) {
		gScrolls = parseInt($(el).css('top').substring(0,$(el).css('top').indexOf('px')));
		$(window).scroll(function() {
			offset = gScrolls + parseInt($(document).scrollTop()) + 10;
			if (offset < top) offset = top;

			if (parseInt(offset) > top - 90) {
				if ((parseInt(offset) + parseInt($(el).height())) < (parseInt($(document).height()) - bottom)) {
					gScrollBanner.stop();
					$(el).animate({top:(offset - top) + 'px'}, {duration:300, queue:false, complete:gScrollBanner.stop()});
				}
			} else {
				gScrollBanner.stop();
				$(el).animate({top:'0px'}, {duration:300, queue:false, complete:gScrollBanner.stop()});
			}
		});
	},
	stop:function(el) {
		$(el).stop(true);
		clearInterval(scroll_banner);
	}
}

/* 가비아 사업자 등록증 */
function popimage(imagesrc,winwidth,winheight){
	var look='width='+winwidth+',height='+winheight+','+'scrollbars'
	popwin=window.open("","",look)
	popwin.document.open()
	popwin.document.write('<title>가비아 사업자등록증 출력-그림을 클릭하시면 닫힙니다.</title><body bgcolor="#FFFFFF"  topmargin=0 leftmargin=0 onload="window.print();"><center><a href="javascript:window.close()" onfocus="this.blur()"><img src="'+imagesrc+'" border=0></a></center></body>')
	popwin.document.close()
}

/* hosting - more less */
$(function(){
    $('.hostingPrice .threeRows .price').hide();
	$('.moreBox .morebtn a').click(function(){
		var clickBtn = $('.moreBox .morebtn img');

		if($('.hostingPrice .threeRows .price').css('display')=='none')
		{
			clickBtn.attr({src:'/assets/common/images/btn_less.gif'});
		} else
		{
			clickBtn.attr({src:'/assets/common/images/btn_more02.gif'});
		}
        $('.hostingPrice .threeRows .price').slideToggle();

		return false;
    });
});

/**
 * @brief  : common initialize
 * @author : Kim In Suk
 * @date   : 2013.03.06
 * @last   : 2013.03.27
 */
$(function() {
	/* rollover */
	$(".rollover").hover(
		function() {this.src = this.src.replace("_off","_on");},
		function() {this.src = this.src.replace("_on","_off");
	});

	/* 131113 롤오버 이미지 키보드 포커스 추가 (손지곤) */
	$(".rollover").parent('a').bind("focus", function(){
		$(this).children('img').attr("src",$(this).children('img').attr("src").replace("_off","_on"));
	});
	$(".rollover").parent('a').bind("blur", function(){
		$(this).children('img').attr("src",$(this).children('img').attr("src").replace("_on","_off"));
	});

	/* login */
	$(".beforeLogin .login").click(function () {
		$(".clickLogin").show();
		$(".beforeLogin").hide();
		$('#user_id').focus();
	});

	/* personal Info Tab */
	$(".personalInfo .extend").click(function () {
		$(".extendDiv").show();
		$(".billDiv").hide();
		$(".csDiv").hide();
		$(".personalInfo .extend a").addClass("on")
		$(".personalInfo .bill a").removeClass("on")
		$(".personalInfo .cs a").removeClass("on")
	});

	$(".personalInfo .bill").click(function () {
		$(".extendDiv").hide();
		$(".billDiv").show();
		$(".csDiv").hide();
		$(".personalInfo .extend a").removeClass("on")
		$(".personalInfo .bill a").addClass("on")
		$(".personalInfo .cs a").removeClass("on")
	});

	$(".personalInfo .cs").click(function () {
		$(".extendDiv").hide();
		$(".billDiv").hide();
		$(".csDiv").show();
		$(".personalInfo .extend a").removeClass("on")
		$(".personalInfo .bill a").removeClass("on")
		$(".personalInfo .cs a").addClass("on")
	});

	/* personal Table */
	$(".personalInfo table tr:nth-child(odd)").addClass("striped");

	/* cs, nameserver */
	$(".customerArea .cs").click(function () {
		$(".customerTab").show();
		$(".nameserverTab").hide();
		$(".customerArea .cs img").attr({src:"/assets/common/images/tab_index_name01_on.gif"});
		$(".customerArea .name img").attr({src:"/assets/common/images/tab_index_name02_off.gif"});
	});

	$(".customerArea .name").click(function () {
		$(".nameserverTab").show();
		$(".customerTab").hide();
		$(".customerArea .cs img").attr({src:"/assets/common/images/tab_index_name01_off.gif"});
		$(".customerArea .name img").attr({src:"/assets/common/images/tab_index_name02_on.gif"});
	});

	/* cs, nameserver sub */
	$(".contSummary .under.customerArea .cs").click(function () {
		$(".contSummary .under.customerArea .customerTab").show();
		$(".contSummary .under.customerArea .nameserverTab").hide();
		$(".contSummary .under.customerArea .cs img").attr({src:"/assets/common/images/tab_nametab01_on.gif"});
		$(".contSummary .under.customerArea .name img").attr({src:"/assets/common/images/tab_nametab02_off.gif"});
		$(".contSummary .under.customerArea .name").css({'top':'38px'});
	});

	$(".contSummary .under.customerArea .name").click(function () {
		$(".contSummary .under.customerArea .nameserverTab").show();
		$(".contSummary .under.customerArea .customerTab").hide();
		$(".contSummary .under.customerArea .cs img").attr({src:"/assets/common/images/tab_nametab01_off.gif"});
		$(".contSummary .under.customerArea .name img").attr({src:"/assets/common/images/tab_nametab02_on.gif"});
		$(".contSummary .under.customerArea .name").css({'top':'39px'});
	});

	/* mygabia cs, nameserver sub */
	$(".contSummary .under.mygabiaCS .cs").click(function () {
		$(".contSummary .under.mygabiaCS .customerTab").show();
		$(".contSummary .under.mygabiaCS .nameserverTab").hide();
		$(".contSummary .under.mygabiaCS .cs img").attr({src:"/assets/common/images/tab_index_name01_on.gif"});
		$(".contSummary .under.mygabiaCS .name img").attr({src:"/assets/common/images/tab_index_name02_off.gif"});
	});

	$(".contSummary .under.mygabiaCS .name").click(function () {
		$(".contSummary .under.mygabiaCS .nameserverTab").show();
		$(".contSummary .under.mygabiaCS .customerTab").hide();
		$(".contSummary .under.mygabiaCS .cs img").attr({src:"/assets/common/images/tab_index_name01_off.gif"});
		$(".contSummary .under.mygabiaCS .name img").attr({src:"/assets/common/images/tab_index_name02_on.gif"});
	});

	/* submenu line */
	/* 불필요하여 제거 (lmk@gabia.com)
	$(function () {

		var rz = function () {
		$('.wrap .submenu .submenuWrap .subFirst > dd')
			.css('height', $('.submenuWrap .subFirst').height() + 'px');
		};

		rz();
	})
	*/

	/**
	 * 2013-04-16 lmk@gabia.com
	 * @brief : initialize script 정리
	 */

	 /*
	/// submenu
	$('.rollover').hover(function() {
		$('.submenu').hide();
		$('#' + $(this).attr('rel')).show();
	}, function() {
		if (!$('.rollover').is(':visible')) {
			$('.submenu').hide();
		}
	});

	$('.submenu').hover(function() {
		$(this).show();
	},function() {
		$(this).hide();
	});

	/// 서브메뉴 닫기
	$(".gnb .submenuClose").click(function () {
		$(".submenu").hide();
	});

	///마우스 위로 올리면 서브메뉴 닫기
	$(".gnbWrap").mouseover(function () {
		$(".submenu").hide();
	});

	/// 스크롤이 0~50 사이인 경우 submenu 닫기
	$(window).scroll(function() {
		if ($(window).scrollTop() > 65) {
			$(".submenu").hide();
		} else {
			$('.submenu').hover(function() {
				$(this).show();
			},function() {
				$(this).hide();
			});
		}
	});
	*/

	 /* 131113 GNB 키보드 접근성 관련 수정 (손지곤) */
	/// submenu
	$('.gnb .rollover').parent('a').bind("mouseover focus", function(){
		$('.gnb .submenu').hide();
		$('#' + $(this).children('img').attr('rel')).show();
	});
	$('.gnb .rollover').parent('a').bind("mouseout blur", function(){
		if (!$('.rollover').is(':visible')) {
			$('.gnb .submenu').hide();
		}
	});

	$('.gnb .submenu').bind("mouseover focus", function(){
		$(this).show();
	});
	$('.gnb .submenu').bind("mouseout blur", function(){
		$(this).hide();
	});

	$('.gnb a').filter(':last').bind("blur", function(){
		$('.gnb .submenu').hide();
	});

	/// 서브메뉴 닫기 (닫기버튼 현재 없어졌음)
	$(".gnb .submenuClose").click(function () {
		$(".gnb .submenu").hide();
	});

	///마우스 위로 올리면 서브메뉴 닫기
	$(".gnbWrap").mouseover(function () {
		$(".gnb .submenu").hide();
	});

	/// 스크롤이 0~50 사이인 경우 submenu 닫기
	$(window).scroll(function() {
		if ($(window).scrollTop() > 65) {
			$(".gnb .submenu").hide();
		} else {
			$('.gnb .submenu').bind("mouseover focus", function(){
				$(this).show();
			});
			$('.gnb .submenu').bind("mouseout blur", function(){
				$(this).hide();
			});
		}
	});







	/// 2013-09-17 lmk@gabia.com
	/// 브라우저 리사이즈시 background 재설정 및 레이어 위치 조정 추가
	$(window).resize(function() {
		/// 레이어 위치 조정
		if (current_glayer_id) {
			$('div[id*=LayerPopup]').css({'width':$(document).width(),'height':$(document).height()});
			gLayer.relocate(current_glayer_id);
		}
	});

	/// 전체서비스
	$(".gnb .serviceAll").click(function () {
		$(".allService").css({visibility:"visible", display:"block"});
		$('.allService .serviceWrap').focus();
	});
	$(".wrap .allService .serviceClose").click(function () {
		$(".allService").hide();
		$('.gnb .serviceAll > a').focus();
	});
});

/// 브라우저 체크 (jhlee@gabia.com)
(function($) {
	var matched, browser;
	$.uaMatch = function( ua ) {
		ua = ua.toLowerCase();
		var match = /(chrome)[ \/]([\w.]+)/.exec( ua ) ||
			/(webkit)[ \/]([\w.]+)/.exec( ua ) ||
			/(opera)(?:.*version|)[ \/]([\w.]+)/.exec( ua ) ||
			/(msie|ie) ([\w.]+)/.exec( ua ) ||
			ua.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec( ua ) ||
			[];

		return {
			browser: match[ 1 ] || "",
			version: match[ 2 ] || "0"
		};
	};

	matched = $.uaMatch( navigator.userAgent );
	browser = {};

	if ( matched.browser ) {
		browser[ matched.browser ] = true;
		browser.version = matched.version;
	}

	// Chrome is Webkit, but Webkit is also Safari.
	if ( browser.chrome ) browser.webkit = true;
	else if ( browser.webkit ) browser.safari = true;

	$.browser = browser;
})(jQuery);

/// z-index indent (jhlee@gabia.com)
$.maxZIndex = $.fn.maxZIndex = function(opt) {
	try
	{
		var def = { inc: 10, group: "*" };
		$.extend(def, opt);
		var zmax = 0;
		$(def.group).each(function() {
			var cur = parseInt($(this).css('z-index'), 10);
			zmax = cur >= zmax ? (cur+1) : zmax;
		});

		if (!this.jquery) return zmax;

		return this.each(function() {
			zmax += def.inc;
			$(this).css({"z-index" : zmax});
		});
	} catch(E)
	{
		$(this).css({"z-index" : zmax});
	}
}

/*
(function ($) {

$.maxZIndex = function (selector) {
	/// <summary>
	/// 	Returns the highest (top-most) zIndex in the document
	/// 	(minimum value returned: 0).
	/// </summary>
	/// <param name="selector" type="String" optional="true">
	/// 	(optional, default = "*") jQuery selector specifying
	/// 	the elements to use for calculating the highest zIndex.
	/// </param>
	/// <returns type="Number">
	/// 	The minimum number returned is 0 (zero).
	/// </returns>

	return Math.max(0, Math.max.apply(null, $.map(((selector || "*") === "*")? $.makeArray(document.getElementsByTagName("*")) : $(selector),
		function (v) {
			return parseFloat($(v).css("z-index")) || null;
		}
	)));
};

$.fn.maxZIndex = function (opt) {
	/// <summary>
	/// 	Increments the CSS z-index of each element in the matched set
	/// 	to a value larger than the highest current zIndex in the document.
	/// 	(i.e., brings all elements in the matched set to the top of the
	/// 	z-index order.)
	/// </summary>
	/// <param name="opt" type="Object" optional="true">
	/// 	(optional) Options, with the following possible values:
	/// 	increment: (Number, default = 1) increment value added to the
	/// 		highest z-index number to bring an element to the top.
	/// 	selector: (String, default = "*") jQuery selector specifying
	/// 		the elements to use for calculating the highest zIndex.
	/// </param>
	/// <returns type="jQuery" />
	try
	{
		// Do nothing if matched set is empty
		if (this.length === 0) {
			return this;
		}

		opt = $.extend({increment: 1}, opt);

		// Get the highest current z-index value
		var zmax = $.maxZIndex(opt.selector),
			inc = opt.increment;

		// Increment the z-index of each element in the matched set to the next highest number
		return this.each(function () {
			this.style.zIndex = (zmax += inc);
		});
	}
	catch(E)
	{
		//
	}
};

})(jQuery);
*/
/**
 * javascript number_formatter
 * @author : lmk@gabia.com
 */
var Comma = {
	set:function(num)
	{
		if (num == 0 || num == undefined) return 0;
		str = '' + num + '';	///문자열 형변환
		var returnVal = "";
		for (k=0; k < str.length; k++)
		{
			if(k > 0 && (k%3)==0)
				returnVal = str.charAt(str.length - k -1) + "," + returnVal;
			else
				returnVal = str.charAt(str.length - k -1) + returnVal;
		}
		return returnVal;
	},
	remove:function(str)
	{
                if (!str) return 0;
                else {
                    return  parseInt(str.replace(/,/gi, ""));
		}
	}
}

/**
 * service all view banner rolling
 * from domain index banner roll (https://domain.gabia.com)
 */
var gnb_banner_timer;
var gbanner = {
	init: function()
	{
		gbanner.gnb_current_idx = 0;
		gbanner.banner_items = $("#gnb_rollBanner li");
		gbanner.gnb_banner_cnt = gbanner.banner_items.length;
		$("#gnb_rollMove img").hover(function(e) {
			clearInterval(gnb_banner_timer);
			gbanner.show($(this).index());
		}, function(e) {
			gbanner.timer();
		});
		gbanner.timer();
	},
	timer: function ()
	{
		gnb_banner_timer = setInterval(function() { gbanner.auto_change(); }, 3000);
	},
	auto_change: function()
	{
		if(gbanner.gnb_current_idx+1>=gbanner.gnb_banner_cnt)
			gbanner.show(0);
		else
			gbanner.show(gbanner.gnb_current_idx+1);
	},
	show: function(idx)
	{
		if(gbanner.gnb_current_idx==idx || idx<0 || idx>=gbanner.bannerCount) return;
		var current_banner = gbanner.banner_items.eq(gbanner.gnb_current_idx);
		var next_banner = gbanner.banner_items.eq(idx);

		current_banner.hide();
		next_banner.show();

		var banner_pagnation = $("#gnb_rollMove img");

		for(var i=0; i < gbanner.gnb_banner_cnt; i++) {
			if(i == idx) banner_pagnation.eq(i).attr("src", "/assets/common/images/btn_roll_on.gif");
			else banner_pagnation.eq(i).attr ("src", "/assets/common/images/btn_roll_off.gif");
		}
		gbanner.gnb_current_idx = idx;
	}
}

/**
 * @author : lmk@gabia.com
 * @brief : 소셜로그인 연동 스크립트 추가
 */
function gsocial_login(sns, main_login_flag)
{
	WWW_SITE = "https://www.gabia.com";
	url = WWW_SITE + "/snsid/auth/" + sns;

    if($("#glogin_common_layer").is(":visible")) {
    	if(login_layer){
            login_layer.dialog('close');
		} else{
            $("#glogin_common_layer").dialog('close');
		}
    }

	if(main_login_flag == 'Y'){ // 로그인 레이어에서 소셜 로그인 할 경우
		document.domain = "gabia.com";
		window.open(url + "?origin_site=" + location.hostname + "&target_url=" + location.pathname + "&main_login_flag=Y", "social_login", "width=1030,height=660,resizable=yes");
	} else if (location.pathname == '/mygabia/myinfo'){ // mygabia에서 연동할 경우
		window.open(url + "?origin_site=" + location.hostname + "&target_url=" + location.pathname, "social_login", "width=1030,height=660,resizable=yes");
	} else { // 기본 로그인할 경우
		window.open(url, "social_login", "width=1030,height=660,resizable=yes");
	}
}

/**
 * @author : lmk@gabia.com
 * @brief : jQuery.serialize <-> unserialize 기능 추가
 * @date :  2013-09-25
 * @update : 2013-09-26 공백문자(+)를 공백으로 치환 추가
 */
$.unserialize = function(param) {
	var str = decodeURI(param);
	var part = str.split('&');
	var obj = {}, p, idx, val;

	for (var i=0, n=part.length; i < n; i++) {
		p = part[i].split('=');
		idx = p[0];

		if (idx.indexOf("[]") == (idx.length - 2)) {
			var ind = idx.substring(0, idx.length-2);
			if (obj[ind] === undefined) {
				obj[ind] = [];
			}
			obj[ind].push(p[1].replace(/\+/g, " "));
		} else {
			obj[idx] = p[1].replace(/\+/g, " ");
		}
	}
	return obj;
}

function isBlank(obj)
{
    return(!obj || $.trim(obj) === "");
}

/* 131120 sjg 추가 (마우스, 키보드 포커스 관련) */
$.fn.clickTargetFocus = function(a,b) {
	$(a).click(function(){
		$(b).attr({ 'tabindex' : '0' }).focus();
	});
}
$.fn.blurTargetFocus = function(a,b) {
	$(a).blur(function(){
		$(b).attr({ 'tabindex' : '0' }).focus();
	});
}
$.fn.layerPosition = function(a,b,c) {
	$(a).css({ 'left' : b, 'top' : c });
}


/* 140612_ GNB, Footer 리뉴얼 (맑은고딕 버전, 손지곤 추가) */
$(function() {
	var curHeight = $('.gnb_txt').height();
	var paddingBottomOver = 100;
	var totalHeight;

	$('.gnb_v2').mouseover(function() {
		$('.gnb_txt_sub').css({'display':'block'});
	});

	$('.gnb_v2>li').mouseover(function() {
		$('.gnb_v2>li').removeClass('on');
		$(this).addClass('on');
		$('.gnb_txt_sub').css({'z-index':'910'});
		$(this).children('.gnb_txt_sub').css({'z-index':'920'});
		totalHeight = parseInt(curHeight + $(this).children('.gnb_txt_sub').height() - paddingBottomOver);
		$('.gnb_txt').stop().animate({height:totalHeight},400);
	});
	$('.gnb_v2>li').mouseout(function() {
		$('.gnb_v2>li').removeClass('on');
		$('.gnb_txt').stop().animate({height:curHeight},400);
	});

	$('.gnb_v2>li>a').focus(function() {
		$('.gnb_v2>li').removeClass('on');
		$(this).parent('li').addClass('on');
		$('.gnb_txt_sub').css({'z-index':'910' , 'display':'none'});
		$(this).next('.gnb_txt_sub').css({'z-index':'920' , 'display':'block'});
		totalHeight = parseInt(curHeight + $(this).next('.gnb_txt_sub').height() - paddingBottomOver);
		$('.gnb_txt').stop().animate({height:totalHeight},400);
	});

	$('.service_all_view>a').focus(function() {
		$('.gnb_v2>li').removeClass('on');
		$('.gnb_txt_sub').css({'z-index':'910' , 'display':'none'});
	});

	$('.gnb_v2 a').filter(':last').blur(function() {
		$('.gnb_v2>li').removeClass('on');
		$('.gnb_txt').stop().animate({height:curHeight},400);
	});
	$('.login_search .search_v2 button.btn').focus(function() {
		$('.gnb_v2>li').removeClass('on');
		$('.gnb_txt').stop().animate({height:curHeight},400);
	});

	/* 서비스 전체보기 */
	$('.service_all_view').click(function() {
		$('.service_all_detail').show(0);
	});
	/* 전체보기에서 메뉴 검색후 클릭 안먹힘
	$('.service_all_detail .close').click(function() {
		$('.service_all_detail').hide();
		$('.service_all_view>a').focus();
	}); */

	/* login */
	$('.login_v2 .box.id, .login_v2 .box.pw').focus(function() {
		$(this).parent('label').parent('li').find('.title').hide();
	});
	$('.login_active .title').click(function() {
		$(this).hide();
		$(this).parent('li').find('.box').focus();
	});
	$('.login_v2 .box.id, .login_v2 .box.pw').blur(function() {
		if ( $(this).val() == '' ) {
			$(this).parent('label').parent('li').find('.title').show();
		}
	});
	$('#loginShow').click(function() {
		$('.login_before').hide();
		$('.login_active').show();
		$('.login_active .box.id').focus();
	});
});
/* //140612_ GNB, Footer 리뉴얼 (맑은고딕 버전, 손지곤 추가) */


/* 약관 레이어 리뉴얼 이동 (www assets/js/payment/payment_v2_ui.js --> ) - 171018 sjg */
function clauseNew(agreementNum) {
	var agreement_array = {1:" 회원약관",2:"도메인 통합 약관",3:"인터넷키워드 등록약관",4:"모바일주소 통합 약관",5:"경매 서비스 약관",6:"매매 서비스 약관",7:"한글키워드 등록 약관",8:"호스팅 통합 약관",9:"서버호스팅 및 코로케이션 서비스 이용 약관",18:"1분 설치 서버호스팅 서비스 이용 약관",10:"g클라우드 서비스 약관",11:"호스팅 파트너 약관",12:"SMS호스팅 약관",13:"도메인 파트너 약관",14:"검색 등록 약관",15:"검색 광고 약관",16:"가비아빌 약관",17:"서버호스팅 통합약관2", 19:"공공기관 전용 g클라우드 서비스 약관", 20:"서버 모니터링 (SMS) 서비스 이용 약관", 21:"홈페이지 제작 이용 약관", 22:"전자세금계산서 이용 약관"};
	var layer_shell = '<div id="layerShell" class="layerpop_a" style="width:820px;"><div class="head"><h3 id="agreeTitle"></h3></div><div id="agreeContents" class="body scroll" style="height:500px;"></div><a class="close" href="javascript:void(0)" onclick="$(this).parent(\'.layerpop_a\').remove()">레이어 닫기</a></div>';
	$('body').append(layer_shell);
	if ( agreementNum == 'policy_collect' ) {
		$('#agreeTitle').text('개인정보 수집ㆍ이용 안내');
		$('#agreeContents').load('/agreements/policy_collect #agreementWrap');
	} else {
		$('#agreeTitle').text(agreement_array[agreementNum]);
		$('#agreeContents').load('/agreements/getContents', {'num':agreementNum});
	}
	$('#layerShell').css({
		'position': 'fixed',
		'top': '50%',
		'left': '50%',
		'marginLeft': ($('#layerShell').outerWidth() / 2) * -1,
		'marginTop': ($('#layerShell').outerHeight() / 2) * -1
	});
}

/*
 *  인증 유효 시간 카운팅
 *  (html 예시)
 *  <div id="layerId">
 *  	<div class="auth_counter Inline Ml5" style="display: none;">
 *      	<span class="font_color_red Fs11">인증 유효시간: </span><span class="font_color_red Fs11 counter"></span>
 *  	</div>
 *  </div>
 */
var authCounter = (function (authCounter, $) {
    var counter;

    /*
     * Init functions
     */
    authCounter.create = function (layerId, minute) {
        authCounter.remove();

        var countMinute = new Date().getTime() + (minute * 60000); // 5분

        layerId = "#" + layerId;

        authCounter.counter = setInterval(function () {
            var now = new Date().getTime();

            var interval = countMinute - now;

            var minutes = Math.floor((interval % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((interval % (1000 * 60)) / 1000);

            if (interval > 0) {
                $(layerId).find(".auth_counter").show();
                $(layerId).find(".counter").html(minutes + "분 " + seconds + "초");
            } else {
                $(layerId).find(".counter").html("초과 (인증번호 재발송 필요)");
                clearInterval(authCounter.counter);
            }
        }, 1000);
    };

    authCounter.remove = function(layerId) {
    	if (layerId) {
            layerId = "#" + layerId;
            $(layerId).find(".auth_counter").hide();
		}

        clearInterval(authCounter.counter); // 카운터 하나만 작동
    };

    return authCounter;
})(authCounter || {}, jQuery);